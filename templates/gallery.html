{% extends 'base.html' %}
{% block content %}
<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="fw-bold">MoreVistas Experience</h1>
        <p class="text-muted">Explore our luxury villas by categories</p>
        
        <div class="mt-4" id="filter-buttons">
            <button class="btn btn-outline-primary active rounded-pill px-4 m-1" onclick="filterGallery('all')">All</button>
            <button class="btn btn-outline-primary rounded-pill px-4 m-1" onclick="filterGallery('Pool')">Pool</button>
            <button class="btn btn-outline-primary rounded-pill px-4 m-1" onclick="filterGallery('Bedroom')">Bedrooms</button>
            <button class="btn btn-outline-primary rounded-pill px-4 m-1" onclick="filterGallery('Hall')">Living Area</button>
            <button class="btn btn-outline-primary rounded-pill px-4 m-1" onclick="filterGallery('Kitchen')">Kitchen</button>
        </div>
    </div>

    <div class="row g-4" id="gallery-grid">
        {% for villa in villas %}
            {% for key in ['Image_Main', 'Image_2', 'Image_3'] %}
                {% if villa[key] %}
                <div class="col-md-4 col-sm-6 gallery-item {{ villa.Category }}">
                    <div class="gallery-card shadow-sm rounded-4 overflow-hidden position-relative" onclick="openFullScreen('{{ villa[key] }}')">
                        <img src="{{ villa[key] }}" class="img-fluid w-100" style="height: 280px; object-fit: cover;">
                        <div class="gallery-tag">{{ villa.Category }}</div>
                        <div class="gallery-overlay">
                            <i class="bi bi-zoom-in text-white fs-2"></i>
                        </div>
                    </div>
                </div>
                {% endif %}
            {% endfor %}
        {% endfor %}
    </div>
</div>

<div id="fullScreenModal" class="fullscreen-modal" onclick="closeFullScreen()">
    <span class="close-btn">&times;</span>
    <img class="modal-content" id="fullImg">
</div>

<style>
    .gallery-tag {
        position: absolute; bottom: 15px; left: 15px;
        background: rgba(255, 255, 255, 0.9); color: #0f172a;
        padding: 5px 15px; border-radius: 50px; font-size: 12px; font-weight: 700;
    }
    .gallery-item { transition: 0.4s; }
    .gallery-card:hover .gallery-overlay { opacity: 1; }
    .gallery-overlay {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(15, 23, 42, 0.5); display: flex; align-items: center;
        justify-content: center; opacity: 0; transition: 0.3s; cursor: pointer;
    }
    
    /* Fullscreen Modal Styles */
    .fullscreen-modal {
        display: none; position: fixed; z-index: 9999; left: 0; top: 0;
        width: 100%; height: 100%; background: rgba(0,0,0,0.9);
        align-items: center; justify-content: center;
    }
    .modal-content { max-width: 90%; max-height: 90%; border-radius: 10px; animation: zoom 0.3s; }
    @keyframes zoom { from {transform:scale(0.8)} to {transform:scale(1)} }
    .close-btn { position: absolute; top: 20px; right: 35px; color: #fff; font-size: 40px; cursor: pointer; }
</style>

<script>
    function filterGallery(category) {
        let items = document.getElementsByClassName('gallery-item');
        let buttons = document.querySelectorAll('#filter-buttons .btn');
        
        // Active button style
        buttons.forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');

        for (let item of items) {
            if (category === 'all' || item.classList.contains(category)) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        }
    }

    function openFullScreen(src) {
        document.getElementById("fullImg").src = src;
        document.getElementById("fullScreenModal").style.display = "flex";
    }
    function closeFullScreen() {
        document.getElementById("fullScreenModal").style.display = "none";
    }
</script>
{% endblock %}
